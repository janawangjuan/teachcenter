webpackJsonp([1],{"4uNA":function(t,e){},To5E:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("hRKE"),s=a.n(i),o=a("4YfN"),n=a.n(o),l=a("OOvn"),r=a("K0Qi"),c={name:"noData",props:{text:{type:String,default:"暂无数据"}}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"no-data"},[this._m(0),this._v(" "),e("p",{staticClass:"no-text"},[this._v(this._s(this.text))])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"img-wrap"},[e("img",{staticClass:"img-no",attrs:{src:a("a4/I"),alt:"暂无内容"}})])}]};var p=a("C7Lr")(c,u,!1,function(t){a("4uNA")},"data-v-1626030f",null).exports,d=a("84iU"),f=a.n(d),h=a("48sp"),g={name:"courseQRCode",computed:n()({techLoginInfo:function(){return JSON.parse(this.cookie.get("techLoginInfo"))}},Object(h.d)({host:function(t){return t.global.host}})),components:{uploadPicture:r.a,noData:p},data:function(){return{filterData:{item:"",subject:"",courseType:"",className:"",courseTitle:"",versionTitle:""},uploadHeadersData:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json;charset=UTF-8"},uploadImgData:{token:""},fileList:[],loading:!1,pageNo:1,pageSize:20,showUploadImg:!0,totalCount:0,imageUrl:"",options1:[],options2:[],ItemCategoryList:"",imgPathArr:"",dialogVisible:!1,courseTypeSelectList:[],courseTypeList:[{name:"全部",value:""},{name:"普通网课",value:"onlinecourse"},{name:"普通面授",value:"facecourse"},{name:"网课翻转课程",value:"flipped"},{name:"EZ课程",value:"ezcourse"},{name:"直播课",value:"livelesson"},{name:"趣学",value:"interestcourse"}],tableData:[],selectData:""}},mounted:function(){this.uploadImgData.token=this.techLoginInfo.token,this.findItemCategoryList(),this.getList(),this.getCourseType();var t={page:1,keyword:"aaaa"};function e(t){}(function(){})(t).then(function(t){e(t)})},methods:{getCourseType:function(){var t=this;l.a.ajax("getTeachingType",{token:this.techLoginInfo.token}).then(function(e){e&&"success"==e.state&&(t.courseTypeSelectList=e.data)})},getList:function(){var t=this;this.loading=!0;""!=this.filterData.item&&this.handleArray(this.filterData.item,this.options1,"itemId").itemName,""!=this.filterData.subject&&this.handleArray(this.filterData.subject,this.options2,"courseCategoryId").name,l.a.ajax("getCourseInfoPagerByParam",{token:this.techLoginInfo.token,courseTitle:this.filterData.courseTitle,versionTitle:this.filterData.versionTitle,techItemId:this.filterData.item,teachingType:this.filterData.courseType,courseCategoryId:this.filterData.subject,pageIndex:this.pageNo,pageSize:this.pageSize}).then(function(e){t.loading=!1,e&&"success"==e.state?(t.tableData=e.data.result,t.totalCount=e.data.total):t.webApi.alert(e.msg)})},deleteClick:function(t){var e=this;this.$confirm("此操作将删除该课程二维码, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.ajax("deleteQrcodeByCourseId",{token:e.techLoginInfo.token,courseId:t.courseId}).then(function(t){t&&"success"==t.state?(e.$message({type:"success",message:"删除成功!"}),e.getList()):e.webApi.alert(t.msg)})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleCurrentChange:function(t){this.pageNo=t,this.getList()},handleSizeChange:function(t){this.pageSize=t,this.pageNo=1,this.getList()},searchClassList:function(){this.pageNo=1,this.getList()},uploadClick:function(t){this.selectData=t,this.imageUrl="",this.dialogVisible=!0},confirmUpload:function(){var t=this;""!=this.imageUrl?l.a.ajax("updateQrcodeByCourseId",{token:this.techLoginInfo.token,courseId:this.selectData.courseId,qrcodeUrl:this.imageUrl}).then(function(e){e&&"success"==e.state?(t.dialogVisible=!1,t.$message({message:"课程二维码上传成功！",type:"success"}),t.getList()):t.webApi.alert(e.msg)}):this.webApi.alert("请先上传二维码~")},handleCourseType:function(t){return this.courseTypeList.filter(function(e){return e.value==t}).length>0?this.courseTypeList.filter(function(e){return e.value==t})[0].name:""},handleArray:function(t,e,a){return e.filter(function(e){return e[a]==t})[0]},handleExceed:function(t,e){this.$message.warning("最多只能上传5个文件哦～")},onUploadChange:function(t,e){var a=new FileReader;a.readAsDataURL(t.raw),a.onload=function(t){}},handleRemove:function(t,e){this.imgPathArr=this.imgPathArr.filter(function(e){return e!=t.imgPath})},uploadImgFunc:function(t,e){var a=this,i=t.file,s=new FormData;s.append("file",i),s.append("token",this.techLoginInfo.token),f.a.post("https://api.zbgedu.com/api/base/file/upload",s,{method:"post",headers:{"Content-Type":"multipart/form-data"}}).then(function(t){a.imageUrl=t.data[0].storeFileUrl}).catch(function(t){a.webApi.alert(t.msg)})},changeItem:function(t){this.options2=this.options1.filter(function(e){return t==e.itemId})[0].courseCategoryList,this.filterData.subject=""},findItemCategoryList:function(){var t=this;l.a.ajax("getItemCategory",{token:this.techLoginInfo.token}).then(function(e){e&&"success"==e.state?(t.ItemCategoryList=e.data,t.options1=e.data):t.webApi.alert(e.msg)})},filterCascaderData:function(t){if(t){var e=t,a=[];for(var i in a.push({title:"全部项目",id:""}),e)for(var s in a.push(e[i]),e[s]);return a}return[]},copyData:function(t){var e=Array.isArray(t)?[]:{};for(var a in t)"object"===s()(t[a])?("child"==a&&t[a].unshift({title:"全部科目",id:""}),e[a]=this.copyData(t[a])):e[a]=t[a];return e},getKnowledgeCategory:function(){var t=this;l.a.ajax("getKnowledgeCategory",{token:this.techLoginInfo.token}).then(function(e){if(e&&"success"==e.state){var a=t.copyData(e.data);t.options1=t.filterCascaderData(a)}else t.webApi.alert(e.msg)})}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"courseQRCode-wrap"},[a("div",{staticClass:"filter-wrap"},[a("div",{staticClass:"filter"},[a("el-form",{attrs:{inline:!0,size:"mini"}},[a("el-form-item",{attrs:{label:"项目"}},[a("el-select",{attrs:{placeholder:"项目"},on:{change:t.changeItem},model:{value:t.filterData.item,callback:function(e){t.$set(t.filterData,"item",e)},expression:"filterData.item"}},[a("el-option",{attrs:{value:"",label:"全部项目"}}),t._v(" "),t._l(t.options1,function(t,e){return a("el-option",{key:e,attrs:{value:t.itemId,label:t.itemName}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"科目"}},[a("el-select",{attrs:{placeholder:"科目"},model:{value:t.filterData.subject,callback:function(e){t.$set(t.filterData,"subject",e)},expression:"filterData.subject"}},[a("el-option",{attrs:{value:"",label:"全部科目"}}),t._v(" "),t._l(t.options2,function(t,e){return a("el-option",{key:e,attrs:{value:t.courseCategoryId,label:t.courseCategoryName}})})],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"授课类型"}},[a("el-select",{attrs:{placeholder:"授课类型"},model:{value:t.filterData.courseType,callback:function(e){t.$set(t.filterData,"courseType",e)},expression:"filterData.courseType"}},t._l(t.courseTypeSelectList,function(t,e){return a("el-option",{key:t.value,attrs:{label:t.title,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"课程名称"}},[a("el-input",{attrs:{placeholder:"请输入课程名称"},model:{value:t.filterData.versionTitle,callback:function(e){t.$set(t.filterData,"versionTitle",e)},expression:"filterData.versionTitle"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"教学课程名称"}},[a("el-input",{attrs:{placeholder:"请输入教学课程名称"},model:{value:t.filterData.courseTitle,callback:function(e){t.$set(t.filterData,"courseTitle",e)},expression:"filterData.courseTitle"}})],1)],1),t._v(" "),a("div",{staticClass:"btn-wrap"},[a("a",{staticClass:"search-btn",attrs:{href:"javascript:;"},on:{click:t.searchClassList}},[a("i",{staticClass:"el-icon-search"}),t._v("搜索")])])],1)]),t._v(" "),a("div",{staticClass:"table-wrap"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark",stripe:!0,height:"100%",size:"mini"}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[a("noData")],1),t._v(" "),a("el-table-column",{attrs:{prop:"courseTitle",label:"教学课程名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"versionTitle",label:"课程名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"teachingType",label:"授课类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.handleCourseType(e.row.teachingType)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"seasonTitle",label:"所属版本"}}),t._v(" "),a("el-table-column",{attrs:{prop:"itemName",label:"项目"}}),t._v(" "),a("el-table-column",{attrs:{prop:"courseCategoryName",label:"科目"}}),t._v(" "),a("el-table-column",{attrs:{label:"二维码"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.qrcodeUrl?[a("img",{attrs:{width:"40",height:"40",src:t.host.img+e.row.qrcodeUrl,alt:"二维码"}})]:[t._v("\n            ----\n          ")]]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"qrcodeUpdateName",label:"二维码上传人"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.qrcodeUpdateName?e.row.qrcodeUpdateName:"----"))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"二维码上传时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.qrcodeUpdateDate?t.webApi.formatDate(e.row.qrcodeUpdateDate/1e3,"YMD"):"----"))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.uploadClick(e.row)}}},[t._v("上传二维码")]),a("br"),t._v(" "),e.row.qrcodeUrl?a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.deleteClick(e.row)}}},[t._v("删除二维码")]):t._e()]}}])})],1)],1),t._v(" "),a("div",{staticStyle:{height:"40px","text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next,sizes,total","current-page":t.pageNo,pageSize:t.pageSize,total:t.totalCount},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:"上传二维码",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.showUploadImg?a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"http://api.zbgedu.com/api/base/file/upload","list-type":"picture-card",headers:t.uploadHeadersData,"auto-upload":!0,"show-file-list":!1,limit:1,"on-exceed":t.handleExceed,data:t.uploadImgData,"on-change":t.onUploadChange,"http-request":t.uploadImgFunc,accept:"image/*","on-remove":t.handleRemove}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.host.img+t.imageUrl,width:"100%",height:"100%"}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]):t._e(),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirmUpload}},[t._v("确认")])],1)],1)],1)},staticRenderFns:[]};var v=a("C7Lr")(g,m,!1,function(t){a("dPAL")},"data-v-2760faa0",null);e.default=v.exports},dPAL:function(t,e){}});
//# sourceMappingURL=1.f775b01f95cdc11bc0f1.js.map
