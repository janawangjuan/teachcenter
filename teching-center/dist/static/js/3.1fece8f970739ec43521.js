webpackJsonp([3],{dshE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("3cXf"),i=a.n(s),o=a("aA9S"),n=a.n(o),l=a("4YfN"),r=a.n(l),c=a("48sp"),d=a("OOvn"),f={name:"",description:"",state:1,checkList:[]},h={name:"addRole",computed:r()({},Object(c.d)({addRoleType:function(t){return t.systemManage.addRoleType},selectRole:function(t){return t.systemManage.selectRole}}),{techLoginInfo:function(){return JSON.parse(this.cookie.get("techLoginInfo"))}}),created:function(){this.formData=n()({},f)},mounted:function(){"edit"==this.addRoleType&&this.getRoleDetail(),this.getMenuList(),this.updateShowUserBack(!0)},watch:{formData:{handler:function(t,e){if(""==t.name?this.disabled=!0:this.disabled=!1,t.checkList.length>0)this.resetDisabled=!1;else for(var a in f)if("checkList"!=a){if(t[a]!=f[a]){this.resetDisabled=!1;break}this.resetDisabled=!0}},deep:!0}},data:function(){return{formData:null,tableData:[],flag:!0,disabled:!0,resetDisabled:!0}},methods:r()({},Object(c.c)("systemManage",["updateShowUserBack"]),{reset:function(){var t=this;console.log(f),this.formData=f,this.formData.checkList=[],console.log(this.formData),this.flag=!1,this.$nextTick(function(){t.flag=!t.flag})},getRoleDetail:function(){var t=this;d.a.ajax("getRoleDetail",{token:this.techLoginInfo.token,roleId:this.selectRole.id}).then(function(e){t.formData.name=e.data.name,t.formData.description=e.data.description,t.formData.state=e.data.state,t.formData.checkList=e.data.funIdList,t.formData.checkList.length>0&&(t.flag=!1,t.$nextTick(function(){t.flag=!t.flag}))})},changeCheckBoxLeft:function(t,e){var a=this;t?this.formData.checkList.push(e):(this.flag=!1,this.formData.checkList.remove(e),this.tableData.forEach(function(t){t.id==e&&(t.childList.forEach(function(t){a.formData.checkList.remove(t.id)}),a.$nextTick(function(){a.flag=!a.flag}))}))},changeCheckBoxLeft2:function(t,e){var a=this;t?(this.formData.checkList.push(e.id),-1==this.formData.checkList.indexOf(e.parentId)&&(this.flag=!1,this.formData.checkList.push(e.parentId),this.$nextTick(function(){a.flag=!a.flag}))):this.formData.checkList.remove(e.id)},confirm:function(){var t=this;if(""!=this.formData.name){this.disabled=!0;var e={roleId:"create"==this.addRoleType?"":this.selectRole.id,roleName:this.formData.name,state:this.formData.state,description:this.formData.description,funIdList:this.formData.checkList};d.a.ajax("saveTechRole",{token:this.techLoginInfo.token,roleData:i()(e)}).then(function(e){e&&"success"==e.state?(t.disabled=!1,t.$message({type:"success",message:"角色"+("create"==t.addRoleType?"创建":"修改")+"成功~"}),t.$router.push("index")):(t.disabled=!1,t.webApi.alert(e.msg||"服务器异常，请重试~"))})}else this.$message("请输入角色名")},getMenuList:function(){var t=this;d.a.ajax("getMenuList",{token:this.techLoginInfo.token}).then(function(e){t.tableData=e.data})}})},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addRole-wrap"},[a("div",{staticClass:"form-wrap"},[a("el-form",{ref:"form",attrs:{model:t.formData,"label-position":"left","label-width":"120px",size:"normal"}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{attrs:{placeholder:"请输入角色名称",width:"200"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"菜单权限配置"}},[a("div",{staticStyle:{overflow:"hidden"}},[t.flag?a("el-table",{staticStyle:{width:"95%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{label:"一级功能菜单",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-checkbox",{attrs:{checked:t.formData.checkList.indexOf(e.row.id)>-1},on:{change:function(a){return t.changeCheckBoxLeft(a,e.row.id)}}},[t._v(t._s(e.row.name))])]}}],null,!1,3878391050)}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"二级功能菜单"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.childList,function(e){return a("span",{key:e.id,staticClass:"el-select-wrap"},[a("el-checkbox",{attrs:{disabled:"1"==e.isDefault,checked:"1"==e.isDefault||t.formData.checkList.indexOf(e.id)>-1},on:{change:function(a){return t.changeCheckBoxLeft2(a,e)}}},[t._v(t._s(e.name))])],1)})}}],null,!1,672266735)})],1):t._e()],1)]),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",resize:"none",placeholder:"请输入备注内容"},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"启用状态"}},[a("el-radio-group",{model:{value:t.formData.state,callback:function(e){t.$set(t.formData,"state",e)},expression:"formData.state"}},[a("el-radio",{attrs:{label:1}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("停用")])],1)],1),t._v(" "),a("div",{staticClass:"btn-wrap"},[a("el-button",{class:["mr20",t.disabled?"disabled":""],attrs:{disabled:t.disabled},on:{click:t.confirm}},[t._v("确定")]),t._v(" "),a("el-button",{class:[t.resetDisabled?"disabled":""],attrs:{disabled:t.resetDisabled},on:{click:t.reset}},[t._v("重置")])],1)],1)],1)])},staticRenderFns:[]};var m=a("C7Lr")(h,u,!1,function(t){a("x+v2")},null,null);e.default=m.exports},"x+v2":function(t,e){}});
//# sourceMappingURL=3.1fece8f970739ec43521.js.map
