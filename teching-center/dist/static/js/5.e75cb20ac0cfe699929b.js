webpackJsonp([5],{"2xh3":function(e,t){},z8jK:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("4YfN"),o=s.n(a),i=s("OOvn"),r=s("48sp"),n={name:"addUser",computed:o()({},Object(r.d)({addUserType:function(e){return e.systemManage.addUserType},selectUser:function(e){return e.systemManage.selectUser}}),{techLoginInfo:function(){return JSON.parse(this.cookie.get("techLoginInfo"))}}),data:function(){return{jobNumber:"",showFirstStep:!0,noCheck:!0,userInfo:"",showOtherSet:!0,formData:{roleId:"",isAllScope:0,teachingTypes:["1"]},roleList:[],tableData:[{name:""}],ACCA:"",flag:!0,checkList:[],checkList2:[],courseTypeList:[]}},mounted:function(){this.getCourseType(),this.getAllItemCategoryList(),this.getRoleList(),"edit"==this.addUserType&&this.getEditUserInfo(),this.updateShowUserBack(!0)},methods:o()({},Object(r.c)("systemManage",["updateAddUserType","updateSelectUser","updateShowUserBack"]),{check:function(){var e=this;i.a.ajax("getUserByNumber",{token:this.techLoginInfo.token,number:this.jobNumber}).then(function(t){t.data?(e.updateSelectUser(t.data),e.showFirstStep=!1):e.webApi.alert(t.msg||"系统异常，请稍后重试~")})},cancel:function(){this.$router.go(-1)},radioChange:function(e){this.showOtherSet=1!=e},getCourseType:function(){var e=this;i.a.ajax("getCourseTeacheringType",{token:this.techLoginInfo.token}).then(function(t){t&&"success"==t.state&&(e.courseTypeList=t.data)})},confirm:function(){var e=this;""==this.formData.roleId&&this.$message("请选择用户角色~"),i.a.ajax("saveTechUser",{token:this.techLoginInfo.token,memberId:this.selectUser.memberId,roleId:this.formData.roleId,isAllScope:this.formData.isAllScope,teachingTypes:this.formData.teachingTypes.join(","),itemIds:this.checkList.join(","),courseCategoryIds:this.checkList2.join(",")}).then(function(t){t&&"success"==t.state?(e.$message({type:"success",message:("create"==e.addUserType?"添加":"编辑")+"用户成功~"}),e.$router.push("index")):e.$message(t.msg)})},getEditUserInfo:function(){var e=this;i.a.ajax("getEditUserInfo",{token:this.techLoginInfo.token,memberId:this.selectUser.memberId}).then(function(t){e.formData.roleId=t.data.roleId,e.formData.teachingTypes=t.data.teachingTypes?t.data.teachingTypes.split(","):[],e.formData.isAllScope=t.data.isAllScope,1==e.formData.isAllScope&&(e.showOtherSet=!1),e.checkList=t.data.itemIds?t.data.itemIds.split(","):[],e.checkList2=t.data.courseCategoryIds?t.data.courseCategoryIds.split(","):[]})},changeCheckBoxLeft:function(e,t){var s=this;e?this.checkList.push(t):(this.checkList.remove(t),this.tableData.forEach(function(e){e.itemId==t&&(console.log(e.courseCategoryList),e.courseCategoryList.forEach(function(e){s.checkList2.remove(e.courseCategoryId)}))}))},changeCheckBoxLeft2:function(e,t){e?(this.checkList2.push(t.courseCategoryId),-1==this.checkList.indexOf(t.itemId)&&this.checkList.push(t.itemId)):this.checkList2.remove(t.courseCategoryId)},getAllItemCategoryList:function(){var e=this;i.a.ajax("getAllItemCategoryList",{token:this.techLoginInfo.token}).then(function(t){e.tableData=t.data})},getRoleList:function(){var e=this;i.a.ajax("getSelectList",{token:this.techLoginInfo.token,state:"1"}).then(function(t){e.roleList=t.data.filter(function(e){return 1!=e.isSystem})})}}),watch:{jobNumber:function(e){this.noCheck=""==e}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"addUser-wrap"},[e.showFirstStep&&"create"==e.addUserType?s("div",{staticClass:"first-step"},[s("div",{staticClass:"jobNumber-wrap"},[s("span",[e._v("工号")]),e._v(" "),s("el-input",{attrs:{placeHolder:"请输入工号查找用户信息"},model:{value:e.jobNumber,callback:function(t){e.jobNumber=t},expression:"jobNumber"}})],1),e._v(" "),s("div",{staticClass:"btn-wrap"},[s("el-button",{attrs:{disabled:e.noCheck},on:{click:e.check}},[e._v("查询")])],1)]):s("div",{staticClass:"second-step"},[s("div",{staticClass:"form-wrap"},[s("el-form",{ref:"form",attrs:{model:e.formData,"label-position":"left","label-width":"190px",size:"mini"}},[s("el-form-item",{attrs:{label:"个人信息"}},[s("div",{staticClass:"person-info-wrap"},[s("span",{staticClass:"title-span"},[e._v("工号")]),e._v(e._s(e.selectUser.loginName||e.selectUser.nickname))]),s("div",{staticClass:"person-info-wrap"},[s("span",{staticClass:"title-span"},[e._v("姓名")]),e._v(e._s(e.selectUser.realName||e.selectUser.name))]),s("div",{staticClass:"person-info-wrap"},[s("span",{staticClass:"title-span"},[e._v("手机号")]),e._v(e._s(e.selectUser.mobile))])]),e._v(" "),s("el-form-item",{attrs:{label:"所属角色"}},[s("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.formData.roleId,callback:function(t){e.$set(e.formData,"roleId",t)},expression:"formData.roleId"}},e._l(e.roleList,function(e,t){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"是否查看全部数据范围"}},[s("el-radio-group",{on:{change:e.radioChange},model:{value:e.formData.isAllScope,callback:function(t){e.$set(e.formData,"isAllScope",t)},expression:"formData.isAllScope"}},[s("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),s("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),e.showOtherSet?s("el-form-item",{attrs:{label:"授课类型配置"}},[s("el-checkbox-group",{model:{value:e.formData.teachingTypes,callback:function(t){e.$set(e.formData,"teachingTypes",t)},expression:"formData.teachingTypes"}},e._l(e.courseTypeList,function(t){return s("el-checkbox",{key:t.value,attrs:{label:t.value,name:"type"}},[e._v(e._s(t.title))])}),1)],1):e._e(),e._v(" "),e.showOtherSet?s("el-form-item",{attrs:{label:"项目科目权限配置"}},[s("div",{staticStyle:{overflow:"hidden"}},[s("el-table",{staticStyle:{width:"95%"},attrs:{data:e.tableData,border:""}},[s("el-table-column",{attrs:{label:"项目",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-checkbox",{attrs:{value:e.checkList.indexOf(t.row.itemId)>-1},on:{change:function(s){return e.changeCheckBoxLeft(s,t.row.itemId)}}},[e._v(e._s(t.row.itemName)+"\n                  ")])]}}],null,!1,2742934242)}),e._v(" "),s("el-table-column",{attrs:{prop:"address",label:"科目"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.courseCategoryList,function(t){return s("span",{key:t.courseCategoryId,staticClass:"el-checkbox-wrap"},[s("el-checkbox",{attrs:{value:e.checkList2.indexOf(t.courseCategoryId)>-1},on:{change:function(s){return e.changeCheckBoxLeft2(s,t)}}},[e._v(e._s(t.courseCategoryName))])],1)})}}],null,!1,2754931822)})],1)],1)]):e._e(),e._v(" "),s("div",{staticClass:"btn-wrap"},[s("el-button",{staticClass:"mr20",on:{click:e.confirm}},[e._v("确定")]),e._v(" "),s("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)])])},staticRenderFns:[]};var l=s("C7Lr")(n,c,!1,function(e){s("2xh3")},null,null);t.default=l.exports}});
//# sourceMappingURL=5.e75cb20ac0cfe699929b.js.map
